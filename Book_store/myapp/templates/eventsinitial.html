{% load static %}
{% url 'books' as books_url %}
{% url 'authors' as authors_url %}
{% url 'events' as events_url %}
{% url 'pricing' as pricing_url %}

{% block content %}
{% with request.path as path %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'style.css' %}">
    <link rel="stylesheet" href="{% static 'events.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <title>Events</title>
</head>
<body>
    <header>
        <nav>
            <div class="logo">
                <img src="{% static 'images/logo.jpg' %}" alt="Website Logo"> 
            </div>
            <ul>
                <li class="{% if path == 'books_url' %}active{% endif %}"><a href="{% url 'books' %}">Books</a></li>
                <li class="{% if path == 'authors_url' %}active{% endif %}"><a href="{% url 'authors' %}">Authors</a></li>
                <li class="{% if path == 'events_url' %}active{% endif %}"><a href="{% url 'events' %}">Events</a></li>
                <li class="{% if path == 'pricing_url' %}active{% endif %}"><a href="{% url 'pricing' %}">Pricing</a></li>
            </ul>
            <div class="navbar-icons">
                <a href="#" class="icon"><i class="fas fa-shopping-basket"></i></a>
                <a href="#" class="icon"><i class="fas fa-user"></i></a>
            </div>
        </nav>
    </header>
    <button id="openModalButton">Add Event</button>

    <!-- The Modal -->
    <div id="eventModal">
        <div id="modalContent">
            <span id="closeModalButton" style="cursor:pointer;">&times; Close</span>
            <form id="eventForm">
                <input type="text" id="eventName" placeholder="Event Name" required>
                <input type="date" id="eventDate" required>
                <input type="color" id="eventColor" value="#ff0000">
                <button type="submit">Add Event</button>
            </form>
        </div>
    </div>
      
    <div id="calendar"></div>
    <script>
        let events = []; // Array to hold events
    
        // Function to add an event
        function addEvent(eventName, eventDate, eventColor) {
            const newEvent = {
                eventName: eventName,
                date: moment(eventDate).format('YYYY-MM-DD'), // Format date
                color: eventColor
            };
            events.push(newEvent);
            drawCalendar(); // Redraw the calendar
        }
    
        // Function to draw the calendar
        function drawCalendar() {
            const calendar = document.getElementById('calendar');
            calendar.innerHTML = ''; // Clear previous calendar
    
            events.forEach((event, index) => {
                const dayDiv = document.createElement('div');
                dayDiv.className = 'day';
                dayDiv.style.backgroundColor = event.color;
                dayDiv.innerText = `${event.date}: ${event.eventName}`;
                dayDiv.onclick = function() { deleteEvent(index); }; // Attach delete function
                calendar.appendChild(dayDiv);
            });
        }
    
        // Function to delete an event
        function deleteEvent(index) {
            events.splice(index, 1); // Remove the event
            drawCalendar(); // Redraw the calendar
        }
    
        // Event listener for the form submission
        document.getElementById('eventForm').addEventListener('submit', function(e) {
            e.preventDefault(); // Prevent page refresh
            const eventName = document.getElementById('eventName').value;
            const eventDate = document.getElementById('eventDate').value;
            const eventColor = document.getElementById('eventColor').value;
    
            addEvent(eventName, eventDate, eventColor); // Call the addEvent function
            this.reset(); // Reset the form
            document.getElementById('eventModal').style.display = 'none'; // Close the modal
        });
    
        // Open the modal
        document.getElementById('openModalButton').addEventListener('click', function() {
            document.getElementById('eventModal').style.display = 'block'; // Show the modal
        });
    
        // Close the modal
        document.getElementById('closeModalButton').addEventListener('click', function() {
            document.getElementById('eventModal').style.display = 'none'; // Close the modal
        });
    
        // Initialize the calendar
        drawCalendar();
    </script>
    
    <script src="{% static 'events.js' %}"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
</body>
</html>

{% endwith %}
{% endblock %}